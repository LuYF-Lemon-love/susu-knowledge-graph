## 介绍

一些神经关系抽取 (Neural Relation Extraction, NRE) 的 C++ 实现, 利用多线程加速模型的训练和测试.

神经关系抽取旨在用神经网络模型从纯文本中抽取关系, 这是最先进的关系抽取方法.

## 数据

### [NYT10](./data.zip)

The original data of NYT10 can be downloaded from:

Relation Extraction:  NYT10 is originally released by the paper "Sebastian Riedel, Limin Yao, and Andrew McCallum. Modeling relations and their mentions without labeled text." [[Download]](http://iesl.cs.umass.edu/riedel/ecml/)

Pre-Trained Word Vectors are learned from New York Times Annotated Corpus (LDC Data LDC2008T19), which should be obtained from LDC (https://catalog.ldc.upenn.edu/LDC2008T19).

The train set is generated by merging all training data of manual and held-out datasets, deleted those data that have overlap with the test set, and used the remain one as our training data.

To run the code, the dataset should be put in the folder **data/** using the following format, containing four files

- **train.txt**: training file, format (fb_mid_e1, fb_mid_e2, e1_name, e2_name, relation, sentence).

- **test.txt**: test file, same format as train.txt.

- **relation.txt**: all relations, one per line.

- **vec.bin**: the pre-train word embedding file.

## CNN+ATT

**CNN+ATT** 是一种**基于语句级别选择性注意力机制**的神经网络模型, 用于构建**基于远程监督**的**关系抽取系统**.

对应的博客: https://www.luyf-lemon-love.space/4249978267/ .

**CNN+ATT** 原论文链接: [Neural Relation Extraction with Selective Attention over Instances](https://aclanthology.org/P16-1200v2.pdf).

### 使用

```bash
$ ls
clean.sh  init.h  run.sh  test.cpp  test.h  train.cpp
$ bash run.sh 

##################################################

./build 和 ./output 目录创建成功.

##################################################

Init start...

训练数据和测试数据加载成功!

batch: 40
number of threads: 32
learning rate: 0.00125000
init_rate: 1.00
reduce_epoch: 0.98
epochs: 25

word_total: 114043
word dimension: 50

limit: 30
position_total_head: 61
position_total_tail: 61
dimension_pos: 5

window: 3
dimension_c: 230

relation_total: 53
dropout_probability: 0.50

将会保存模型.
note: 

folder of data: ../data/
folder of outputing results (precion/recall curves) and models: ./output/

number of training samples:  281270 - average sentence number of per training sample: 1.86
number of testing samples:    96678 - average sentence number of per testing sample:  1.78

Init end.

##################################################

Train start...

Epoch 1/25 - current_alpha: 0.00125000 - loss: 0.392392 - 00:04:00

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.280 - recall: 0.007
precion/recall curves  100 / 2000 - precision: 0.210 - recall: 0.011
precion/recall curves  150 / 2000 - precision: 0.187 - recall: 0.014
precion/recall curves  200 / 2000 - precision: 0.185 - recall: 0.019
precion/recall curves  250 / 2000 - precision: 0.164 - recall: 0.021
precion/recall curves  300 / 2000 - precision: 0.147 - recall: 0.023
precion/recall curves  350 / 2000 - precision: 0.134 - recall: 0.024
precion/recall curves  400 / 2000 - precision: 0.125 - recall: 0.026
precion/recall curves  450 / 2000 - precision: 0.120 - recall: 0.028
precion/recall curves  500 / 2000 - precision: 0.122 - recall: 0.031
precion/recall curves  550 / 2000 - precision: 0.125 - recall: 0.035
precion/recall curves  600 / 2000 - precision: 0.118 - recall: 0.036
precion/recall curves  650 / 2000 - precision: 0.118 - recall: 0.039
precion/recall curves  700 / 2000 - precision: 0.116 - recall: 0.042
precion/recall curves  750 / 2000 - precision: 0.109 - recall: 0.042
precion/recall curves  800 / 2000 - precision: 0.109 - recall: 0.045
precion/recall curves  850 / 2000 - precision: 0.105 - recall: 0.046
precion/recall curves  900 / 2000 - precision: 0.104 - recall: 0.048
precion/recall curves  950 / 2000 - precision: 0.102 - recall: 0.050
precion/recall curves 1000 / 2000 - precision: 0.101 - recall: 0.052
precion/recall curves 1050 / 2000 - precision: 0.102 - recall: 0.055
precion/recall curves 1100 / 2000 - precision: 0.099 - recall: 0.056
precion/recall curves 1150 / 2000 - precision: 0.097 - recall: 0.057
precion/recall curves 1200 / 2000 - precision: 0.094 - recall: 0.058
precion/recall curves 1250 / 2000 - precision: 0.092 - recall: 0.059
precion/recall curves 1300 / 2000 - precision: 0.090 - recall: 0.060
precion/recall curves 1350 / 2000 - precision: 0.087 - recall: 0.061
precion/recall curves 1400 / 2000 - precision: 0.085 - recall: 0.061
precion/recall curves 1450 / 2000 - precision: 0.083 - recall: 0.062
precion/recall curves 1500 / 2000 - precision: 0.085 - recall: 0.065
precion/recall curves 1550 / 2000 - precision: 0.084 - recall: 0.067
precion/recall curves 1600 / 2000 - precision: 0.083 - recall: 0.068
precion/recall curves 1650 / 2000 - precision: 0.082 - recall: 0.069
precion/recall curves 1700 / 2000 - precision: 0.081 - recall: 0.071
precion/recall curves 1750 / 2000 - precision: 0.081 - recall: 0.073
precion/recall curves 1800 / 2000 - precision: 0.081 - recall: 0.075
precion/recall curves 1850 / 2000 - precision: 0.082 - recall: 0.078
precion/recall curves 1900 / 2000 - precision: 0.080 - recall: 0.078
precion/recall curves 1950 / 2000 - precision: 0.080 - recall: 0.080
precion/recall curves 2000 / 2000 - precision: 0.079 - recall: 0.081

test use time - 00:01:21

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 2/25 - current_alpha: 0.00122500 - loss: 0.312926 - 00:04:58

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.560 - recall: 0.014
precion/recall curves  100 / 2000 - precision: 0.540 - recall: 0.028
precion/recall curves  150 / 2000 - precision: 0.573 - recall: 0.044
precion/recall curves  200 / 2000 - precision: 0.555 - recall: 0.057
precion/recall curves  250 / 2000 - precision: 0.536 - recall: 0.069
precion/recall curves  300 / 2000 - precision: 0.517 - recall: 0.079
precion/recall curves  350 / 2000 - precision: 0.483 - recall: 0.087
precion/recall curves  400 / 2000 - precision: 0.468 - recall: 0.096
precion/recall curves  450 / 2000 - precision: 0.433 - recall: 0.100
precion/recall curves  500 / 2000 - precision: 0.412 - recall: 0.106
precion/recall curves  550 / 2000 - precision: 0.404 - recall: 0.114
precion/recall curves  600 / 2000 - precision: 0.388 - recall: 0.119
precion/recall curves  650 / 2000 - precision: 0.375 - recall: 0.125
precion/recall curves  700 / 2000 - precision: 0.370 - recall: 0.133
precion/recall curves  750 / 2000 - precision: 0.359 - recall: 0.138
precion/recall curves  800 / 2000 - precision: 0.350 - recall: 0.144
precion/recall curves  850 / 2000 - precision: 0.339 - recall: 0.148
precion/recall curves  900 / 2000 - precision: 0.332 - recall: 0.153
precion/recall curves  950 / 2000 - precision: 0.322 - recall: 0.157
precion/recall curves 1000 / 2000 - precision: 0.312 - recall: 0.160
precion/recall curves 1050 / 2000 - precision: 0.304 - recall: 0.164
precion/recall curves 1100 / 2000 - precision: 0.294 - recall: 0.166
precion/recall curves 1150 / 2000 - precision: 0.285 - recall: 0.168
precion/recall curves 1200 / 2000 - precision: 0.279 - recall: 0.172
precion/recall curves 1250 / 2000 - precision: 0.277 - recall: 0.177
precion/recall curves 1300 / 2000 - precision: 0.271 - recall: 0.181
precion/recall curves 1350 / 2000 - precision: 0.264 - recall: 0.183
precion/recall curves 1400 / 2000 - precision: 0.256 - recall: 0.184
precion/recall curves 1450 / 2000 - precision: 0.253 - recall: 0.188
precion/recall curves 1500 / 2000 - precision: 0.249 - recall: 0.191
precion/recall curves 1550 / 2000 - precision: 0.245 - recall: 0.194
precion/recall curves 1600 / 2000 - precision: 0.238 - recall: 0.195
precion/recall curves 1650 / 2000 - precision: 0.233 - recall: 0.197
precion/recall curves 1700 / 2000 - precision: 0.228 - recall: 0.198
precion/recall curves 1750 / 2000 - precision: 0.225 - recall: 0.202
precion/recall curves 1800 / 2000 - precision: 0.220 - recall: 0.203
precion/recall curves 1850 / 2000 - precision: 0.216 - recall: 0.205
precion/recall curves 1900 / 2000 - precision: 0.212 - recall: 0.207
precion/recall curves 1950 / 2000 - precision: 0.208 - recall: 0.208
precion/recall curves 2000 / 2000 - precision: 0.204 - recall: 0.209

test use time - 00:01:22

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 3/25 - current_alpha: 0.00120050 - loss: 0.263319 - 00:04:04

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.500 - recall: 0.013
precion/recall curves  100 / 2000 - precision: 0.550 - recall: 0.028
precion/recall curves  150 / 2000 - precision: 0.560 - recall: 0.043
precion/recall curves  200 / 2000 - precision: 0.585 - recall: 0.060
precion/recall curves  250 / 2000 - precision: 0.556 - recall: 0.071
precion/recall curves  300 / 2000 - precision: 0.527 - recall: 0.081
precion/recall curves  350 / 2000 - precision: 0.506 - recall: 0.091
precion/recall curves  400 / 2000 - precision: 0.490 - recall: 0.101
precion/recall curves  450 / 2000 - precision: 0.460 - recall: 0.106
precion/recall curves  500 / 2000 - precision: 0.448 - recall: 0.115
precion/recall curves  550 / 2000 - precision: 0.433 - recall: 0.122
precion/recall curves  600 / 2000 - precision: 0.420 - recall: 0.129
precion/recall curves  650 / 2000 - precision: 0.405 - recall: 0.135
precion/recall curves  700 / 2000 - precision: 0.394 - recall: 0.142
precion/recall curves  750 / 2000 - precision: 0.379 - recall: 0.146
precion/recall curves  800 / 2000 - precision: 0.371 - recall: 0.152
precion/recall curves  850 / 2000 - precision: 0.362 - recall: 0.158
precion/recall curves  900 / 2000 - precision: 0.353 - recall: 0.163
precion/recall curves  950 / 2000 - precision: 0.348 - recall: 0.170
precion/recall curves 1000 / 2000 - precision: 0.340 - recall: 0.174
precion/recall curves 1050 / 2000 - precision: 0.330 - recall: 0.177
precion/recall curves 1100 / 2000 - precision: 0.325 - recall: 0.183
precion/recall curves 1150 / 2000 - precision: 0.319 - recall: 0.188
precion/recall curves 1200 / 2000 - precision: 0.313 - recall: 0.193
precion/recall curves 1250 / 2000 - precision: 0.307 - recall: 0.197
precion/recall curves 1300 / 2000 - precision: 0.302 - recall: 0.201
precion/recall curves 1350 / 2000 - precision: 0.295 - recall: 0.204
precion/recall curves 1400 / 2000 - precision: 0.288 - recall: 0.207
precion/recall curves 1450 / 2000 - precision: 0.283 - recall: 0.211
precion/recall curves 1500 / 2000 - precision: 0.277 - recall: 0.213
precion/recall curves 1550 / 2000 - precision: 0.270 - recall: 0.214
precion/recall curves 1600 / 2000 - precision: 0.262 - recall: 0.215
precion/recall curves 1650 / 2000 - precision: 0.258 - recall: 0.218
precion/recall curves 1700 / 2000 - precision: 0.255 - recall: 0.223
precion/recall curves 1750 / 2000 - precision: 0.251 - recall: 0.225
precion/recall curves 1800 / 2000 - precision: 0.248 - recall: 0.229
precion/recall curves 1850 / 2000 - precision: 0.243 - recall: 0.230
precion/recall curves 1900 / 2000 - precision: 0.239 - recall: 0.233
precion/recall curves 1950 / 2000 - precision: 0.235 - recall: 0.235
precion/recall curves 2000 / 2000 - precision: 0.231 - recall: 0.237

test use time - 00:01:21

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 4/25 - current_alpha: 0.00117649 - loss: 0.234492 - 00:03:50

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.600 - recall: 0.015
precion/recall curves  100 / 2000 - precision: 0.600 - recall: 0.031
precion/recall curves  150 / 2000 - precision: 0.600 - recall: 0.046
precion/recall curves  200 / 2000 - precision: 0.590 - recall: 0.061
precion/recall curves  250 / 2000 - precision: 0.560 - recall: 0.072
precion/recall curves  300 / 2000 - precision: 0.540 - recall: 0.083
precion/recall curves  350 / 2000 - precision: 0.534 - recall: 0.096
precion/recall curves  400 / 2000 - precision: 0.507 - recall: 0.104
precion/recall curves  450 / 2000 - precision: 0.484 - recall: 0.112
precion/recall curves  500 / 2000 - precision: 0.480 - recall: 0.123
precion/recall curves  550 / 2000 - precision: 0.475 - recall: 0.134
precion/recall curves  600 / 2000 - precision: 0.470 - recall: 0.145
precion/recall curves  650 / 2000 - precision: 0.457 - recall: 0.152
precion/recall curves  700 / 2000 - precision: 0.451 - recall: 0.162
precion/recall curves  750 / 2000 - precision: 0.443 - recall: 0.170
precion/recall curves  800 / 2000 - precision: 0.438 - recall: 0.179
precion/recall curves  850 / 2000 - precision: 0.431 - recall: 0.188
precion/recall curves  900 / 2000 - precision: 0.416 - recall: 0.192
precion/recall curves  950 / 2000 - precision: 0.407 - recall: 0.198
precion/recall curves 1000 / 2000 - precision: 0.401 - recall: 0.206
precion/recall curves 1050 / 2000 - precision: 0.399 - recall: 0.215
precion/recall curves 1100 / 2000 - precision: 0.391 - recall: 0.221
precion/recall curves 1150 / 2000 - precision: 0.384 - recall: 0.227
precion/recall curves 1200 / 2000 - precision: 0.376 - recall: 0.231
precion/recall curves 1250 / 2000 - precision: 0.369 - recall: 0.236
precion/recall curves 1300 / 2000 - precision: 0.366 - recall: 0.244
precion/recall curves 1350 / 2000 - precision: 0.361 - recall: 0.250
precion/recall curves 1400 / 2000 - precision: 0.356 - recall: 0.256
precion/recall curves 1450 / 2000 - precision: 0.350 - recall: 0.260
precion/recall curves 1500 / 2000 - precision: 0.341 - recall: 0.263
precion/recall curves 1550 / 2000 - precision: 0.336 - recall: 0.267
precion/recall curves 1600 / 2000 - precision: 0.333 - recall: 0.273
precion/recall curves 1650 / 2000 - precision: 0.327 - recall: 0.277
precion/recall curves 1700 / 2000 - precision: 0.321 - recall: 0.279
precion/recall curves 1750 / 2000 - precision: 0.314 - recall: 0.282
precion/recall curves 1800 / 2000 - precision: 0.310 - recall: 0.286
precion/recall curves 1850 / 2000 - precision: 0.306 - recall: 0.290
precion/recall curves 1900 / 2000 - precision: 0.302 - recall: 0.294
precion/recall curves 1950 / 2000 - precision: 0.298 - recall: 0.298
precion/recall curves 2000 / 2000 - precision: 0.294 - recall: 0.301

test use time - 00:01:21

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 5/25 - current_alpha: 0.00115296 - loss: 0.211013 - 00:03:39

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.600 - recall: 0.015
precion/recall curves  100 / 2000 - precision: 0.600 - recall: 0.031
precion/recall curves  150 / 2000 - precision: 0.600 - recall: 0.046
precion/recall curves  200 / 2000 - precision: 0.590 - recall: 0.061
precion/recall curves  250 / 2000 - precision: 0.580 - recall: 0.074
precion/recall curves  300 / 2000 - precision: 0.560 - recall: 0.086
precion/recall curves  350 / 2000 - precision: 0.569 - recall: 0.102
precion/recall curves  400 / 2000 - precision: 0.562 - recall: 0.115
precion/recall curves  450 / 2000 - precision: 0.538 - recall: 0.124
precion/recall curves  500 / 2000 - precision: 0.530 - recall: 0.136
precion/recall curves  550 / 2000 - precision: 0.522 - recall: 0.147
precion/recall curves  600 / 2000 - precision: 0.512 - recall: 0.157
precion/recall curves  650 / 2000 - precision: 0.497 - recall: 0.166
precion/recall curves  700 / 2000 - precision: 0.487 - recall: 0.175
precion/recall curves  750 / 2000 - precision: 0.477 - recall: 0.184
precion/recall curves  800 / 2000 - precision: 0.466 - recall: 0.191
precion/recall curves  850 / 2000 - precision: 0.449 - recall: 0.196
precion/recall curves  900 / 2000 - precision: 0.443 - recall: 0.205
precion/recall curves  950 / 2000 - precision: 0.438 - recall: 0.213
precion/recall curves 1000 / 2000 - precision: 0.438 - recall: 0.225
precion/recall curves 1050 / 2000 - precision: 0.428 - recall: 0.230
precion/recall curves 1100 / 2000 - precision: 0.418 - recall: 0.236
precion/recall curves 1150 / 2000 - precision: 0.410 - recall: 0.242
precion/recall curves 1200 / 2000 - precision: 0.404 - recall: 0.249
precion/recall curves 1250 / 2000 - precision: 0.399 - recall: 0.256
precion/recall curves 1300 / 2000 - precision: 0.392 - recall: 0.262
precion/recall curves 1350 / 2000 - precision: 0.386 - recall: 0.267
precion/recall curves 1400 / 2000 - precision: 0.377 - recall: 0.271
precion/recall curves 1450 / 2000 - precision: 0.371 - recall: 0.276
precion/recall curves 1500 / 2000 - precision: 0.367 - recall: 0.283
precion/recall curves 1550 / 2000 - precision: 0.360 - recall: 0.286
precion/recall curves 1600 / 2000 - precision: 0.357 - recall: 0.293
precion/recall curves 1650 / 2000 - precision: 0.351 - recall: 0.297
precion/recall curves 1700 / 2000 - precision: 0.344 - recall: 0.300
precion/recall curves 1750 / 2000 - precision: 0.340 - recall: 0.305
precion/recall curves 1800 / 2000 - precision: 0.335 - recall: 0.309
precion/recall curves 1850 / 2000 - precision: 0.329 - recall: 0.312
precion/recall curves 1900 / 2000 - precision: 0.325 - recall: 0.317
precion/recall curves 1950 / 2000 - precision: 0.323 - recall: 0.323
precion/recall curves 2000 / 2000 - precision: 0.317 - recall: 0.325

test use time - 00:01:23

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 6/25 - current_alpha: 0.00112990 - loss: 0.201362 - 00:04:17

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.660 - recall: 0.017
precion/recall curves  100 / 2000 - precision: 0.620 - recall: 0.032
precion/recall curves  150 / 2000 - precision: 0.600 - recall: 0.046
precion/recall curves  200 / 2000 - precision: 0.610 - recall: 0.063
precion/recall curves  250 / 2000 - precision: 0.592 - recall: 0.076
precion/recall curves  300 / 2000 - precision: 0.563 - recall: 0.087
precion/recall curves  350 / 2000 - precision: 0.560 - recall: 0.101
precion/recall curves  400 / 2000 - precision: 0.567 - recall: 0.116
precion/recall curves  450 / 2000 - precision: 0.560 - recall: 0.129
precion/recall curves  500 / 2000 - precision: 0.552 - recall: 0.142
precion/recall curves  550 / 2000 - precision: 0.540 - recall: 0.152
precion/recall curves  600 / 2000 - precision: 0.528 - recall: 0.163
precion/recall curves  650 / 2000 - precision: 0.515 - recall: 0.172
precion/recall curves  700 / 2000 - precision: 0.504 - recall: 0.181
precion/recall curves  750 / 2000 - precision: 0.496 - recall: 0.191
precion/recall curves  800 / 2000 - precision: 0.485 - recall: 0.199
precion/recall curves  850 / 2000 - precision: 0.472 - recall: 0.206
precion/recall curves  900 / 2000 - precision: 0.463 - recall: 0.214
precion/recall curves  950 / 2000 - precision: 0.452 - recall: 0.220
precion/recall curves 1000 / 2000 - precision: 0.447 - recall: 0.229
precion/recall curves 1050 / 2000 - precision: 0.438 - recall: 0.236
precion/recall curves 1100 / 2000 - precision: 0.432 - recall: 0.244
precion/recall curves 1150 / 2000 - precision: 0.427 - recall: 0.252
precion/recall curves 1200 / 2000 - precision: 0.421 - recall: 0.259
precion/recall curves 1250 / 2000 - precision: 0.418 - recall: 0.268
precion/recall curves 1300 / 2000 - precision: 0.412 - recall: 0.274
precion/recall curves 1350 / 2000 - precision: 0.405 - recall: 0.281
precion/recall curves 1400 / 2000 - precision: 0.398 - recall: 0.286
precion/recall curves 1450 / 2000 - precision: 0.391 - recall: 0.291
precion/recall curves 1500 / 2000 - precision: 0.385 - recall: 0.296
precion/recall curves 1550 / 2000 - precision: 0.379 - recall: 0.302
precion/recall curves 1600 / 2000 - precision: 0.373 - recall: 0.306
precion/recall curves 1650 / 2000 - precision: 0.369 - recall: 0.312
precion/recall curves 1700 / 2000 - precision: 0.361 - recall: 0.315
precion/recall curves 1750 / 2000 - precision: 0.355 - recall: 0.319
precion/recall curves 1800 / 2000 - precision: 0.351 - recall: 0.324
precion/recall curves 1850 / 2000 - precision: 0.345 - recall: 0.327
precion/recall curves 1900 / 2000 - precision: 0.342 - recall: 0.333
precion/recall curves 1950 / 2000 - precision: 0.337 - recall: 0.337
precion/recall curves 2000 / 2000 - precision: 0.331 - recall: 0.339

test use time - 00:01:22

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 7/25 - current_alpha: 0.00110730 - loss: 0.189826 - 00:03:58

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.640 - recall: 0.016
precion/recall curves  100 / 2000 - precision: 0.620 - recall: 0.032
precion/recall curves  150 / 2000 - precision: 0.627 - recall: 0.048
precion/recall curves  200 / 2000 - precision: 0.595 - recall: 0.061
precion/recall curves  250 / 2000 - precision: 0.592 - recall: 0.076
precion/recall curves  300 / 2000 - precision: 0.577 - recall: 0.089
precion/recall curves  350 / 2000 - precision: 0.560 - recall: 0.101
precion/recall curves  400 / 2000 - precision: 0.565 - recall: 0.116
precion/recall curves  450 / 2000 - precision: 0.576 - recall: 0.133
precion/recall curves  500 / 2000 - precision: 0.560 - recall: 0.144
precion/recall curves  550 / 2000 - precision: 0.562 - recall: 0.158
precion/recall curves  600 / 2000 - precision: 0.543 - recall: 0.167
precion/recall curves  650 / 2000 - precision: 0.525 - recall: 0.175
precion/recall curves  700 / 2000 - precision: 0.520 - recall: 0.187
precion/recall curves  750 / 2000 - precision: 0.515 - recall: 0.198
precion/recall curves  800 / 2000 - precision: 0.500 - recall: 0.205
precion/recall curves  850 / 2000 - precision: 0.495 - recall: 0.216
precion/recall curves  900 / 2000 - precision: 0.481 - recall: 0.222
precion/recall curves  950 / 2000 - precision: 0.482 - recall: 0.235
precion/recall curves 1000 / 2000 - precision: 0.473 - recall: 0.243
precion/recall curves 1050 / 2000 - precision: 0.470 - recall: 0.253
precion/recall curves 1100 / 2000 - precision: 0.462 - recall: 0.261
precion/recall curves 1150 / 2000 - precision: 0.452 - recall: 0.267
precion/recall curves 1200 / 2000 - precision: 0.442 - recall: 0.272
precion/recall curves 1250 / 2000 - precision: 0.436 - recall: 0.279
precion/recall curves 1300 / 2000 - precision: 0.424 - recall: 0.283
precion/recall curves 1350 / 2000 - precision: 0.413 - recall: 0.286
precion/recall curves 1400 / 2000 - precision: 0.404 - recall: 0.290
precion/recall curves 1450 / 2000 - precision: 0.401 - recall: 0.298
precion/recall curves 1500 / 2000 - precision: 0.392 - recall: 0.302
precion/recall curves 1550 / 2000 - precision: 0.389 - recall: 0.309
precion/recall curves 1600 / 2000 - precision: 0.381 - recall: 0.312
precion/recall curves 1650 / 2000 - precision: 0.374 - recall: 0.316
precion/recall curves 1700 / 2000 - precision: 0.370 - recall: 0.323
precion/recall curves 1750 / 2000 - precision: 0.370 - recall: 0.332
precion/recall curves 1800 / 2000 - precision: 0.366 - recall: 0.338
precion/recall curves 1850 / 2000 - precision: 0.362 - recall: 0.343
precion/recall curves 1900 / 2000 - precision: 0.356 - recall: 0.347
precion/recall curves 1950 / 2000 - precision: 0.351 - recall: 0.351
precion/recall curves 2000 / 2000 - precision: 0.345 - recall: 0.354

test use time - 00:01:21

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 8/25 - current_alpha: 0.00108516 - loss: 0.182470 - 00:03:33

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.680 - recall: 0.017
precion/recall curves  100 / 2000 - precision: 0.650 - recall: 0.033
precion/recall curves  150 / 2000 - precision: 0.633 - recall: 0.049
precion/recall curves  200 / 2000 - precision: 0.620 - recall: 0.064
precion/recall curves  250 / 2000 - precision: 0.616 - recall: 0.079
precion/recall curves  300 / 2000 - precision: 0.597 - recall: 0.092
precion/recall curves  350 / 2000 - precision: 0.614 - recall: 0.110
precion/recall curves  400 / 2000 - precision: 0.615 - recall: 0.126
precion/recall curves  450 / 2000 - precision: 0.607 - recall: 0.140
precion/recall curves  500 / 2000 - precision: 0.602 - recall: 0.154
precion/recall curves  550 / 2000 - precision: 0.589 - recall: 0.166
precion/recall curves  600 / 2000 - precision: 0.570 - recall: 0.175
precion/recall curves  650 / 2000 - precision: 0.557 - recall: 0.186
precion/recall curves  700 / 2000 - precision: 0.547 - recall: 0.196
precion/recall curves  750 / 2000 - precision: 0.536 - recall: 0.206
precion/recall curves  800 / 2000 - precision: 0.525 - recall: 0.215
precion/recall curves  850 / 2000 - precision: 0.516 - recall: 0.225
precion/recall curves  900 / 2000 - precision: 0.507 - recall: 0.234
precion/recall curves  950 / 2000 - precision: 0.495 - recall: 0.241
precion/recall curves 1000 / 2000 - precision: 0.484 - recall: 0.248
precion/recall curves 1050 / 2000 - precision: 0.472 - recall: 0.254
precion/recall curves 1100 / 2000 - precision: 0.467 - recall: 0.264
precion/recall curves 1150 / 2000 - precision: 0.463 - recall: 0.273
precion/recall curves 1200 / 2000 - precision: 0.454 - recall: 0.279
precion/recall curves 1250 / 2000 - precision: 0.450 - recall: 0.288
precion/recall curves 1300 / 2000 - precision: 0.440 - recall: 0.293
precion/recall curves 1350 / 2000 - precision: 0.431 - recall: 0.298
precion/recall curves 1400 / 2000 - precision: 0.424 - recall: 0.305
precion/recall curves 1450 / 2000 - precision: 0.419 - recall: 0.311
precion/recall curves 1500 / 2000 - precision: 0.412 - recall: 0.317
precion/recall curves 1550 / 2000 - precision: 0.406 - recall: 0.323
precion/recall curves 1600 / 2000 - precision: 0.399 - recall: 0.328
precion/recall curves 1650 / 2000 - precision: 0.396 - recall: 0.335
precion/recall curves 1700 / 2000 - precision: 0.390 - recall: 0.340
precion/recall curves 1750 / 2000 - precision: 0.382 - recall: 0.343
precion/recall curves 1800 / 2000 - precision: 0.377 - recall: 0.348
precion/recall curves 1850 / 2000 - precision: 0.375 - recall: 0.355
precion/recall curves 1900 / 2000 - precision: 0.368 - recall: 0.359
precion/recall curves 1950 / 2000 - precision: 0.364 - recall: 0.364
precion/recall curves 2000 / 2000 - precision: 0.356 - recall: 0.366

test use time - 00:01:22

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 9/25 - current_alpha: 0.00106345 - loss: 0.174141 - 00:03:59

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.780 - recall: 0.020
precion/recall curves  100 / 2000 - precision: 0.650 - recall: 0.033
precion/recall curves  150 / 2000 - precision: 0.613 - recall: 0.047
precion/recall curves  200 / 2000 - precision: 0.600 - recall: 0.062
precion/recall curves  250 / 2000 - precision: 0.616 - recall: 0.079
precion/recall curves  300 / 2000 - precision: 0.607 - recall: 0.093
precion/recall curves  350 / 2000 - precision: 0.600 - recall: 0.108
precion/recall curves  400 / 2000 - precision: 0.605 - recall: 0.124
precion/recall curves  450 / 2000 - precision: 0.609 - recall: 0.141
precion/recall curves  500 / 2000 - precision: 0.578 - recall: 0.148
precion/recall curves  550 / 2000 - precision: 0.575 - recall: 0.162
precion/recall curves  600 / 2000 - precision: 0.565 - recall: 0.174
precion/recall curves  650 / 2000 - precision: 0.562 - recall: 0.187
precion/recall curves  700 / 2000 - precision: 0.553 - recall: 0.198
precion/recall curves  750 / 2000 - precision: 0.537 - recall: 0.207
precion/recall curves  800 / 2000 - precision: 0.520 - recall: 0.213
precion/recall curves  850 / 2000 - precision: 0.507 - recall: 0.221
precion/recall curves  900 / 2000 - precision: 0.500 - recall: 0.231
precion/recall curves  950 / 2000 - precision: 0.492 - recall: 0.239
precion/recall curves 1000 / 2000 - precision: 0.483 - recall: 0.248
precion/recall curves 1050 / 2000 - precision: 0.471 - recall: 0.254
precion/recall curves 1100 / 2000 - precision: 0.462 - recall: 0.261
precion/recall curves 1150 / 2000 - precision: 0.460 - recall: 0.271
precion/recall curves 1200 / 2000 - precision: 0.452 - recall: 0.278
precion/recall curves 1250 / 2000 - precision: 0.443 - recall: 0.284
precion/recall curves 1300 / 2000 - precision: 0.439 - recall: 0.293
precion/recall curves 1350 / 2000 - precision: 0.435 - recall: 0.301
precion/recall curves 1400 / 2000 - precision: 0.429 - recall: 0.308
precion/recall curves 1450 / 2000 - precision: 0.426 - recall: 0.316
precion/recall curves 1500 / 2000 - precision: 0.420 - recall: 0.323
precion/recall curves 1550 / 2000 - precision: 0.414 - recall: 0.329
precion/recall curves 1600 / 2000 - precision: 0.407 - recall: 0.334
precion/recall curves 1650 / 2000 - precision: 0.400 - recall: 0.338
precion/recall curves 1700 / 2000 - precision: 0.395 - recall: 0.345
precion/recall curves 1750 / 2000 - precision: 0.391 - recall: 0.351
precion/recall curves 1800 / 2000 - precision: 0.384 - recall: 0.355
precion/recall curves 1850 / 2000 - precision: 0.378 - recall: 0.359
precion/recall curves 1900 / 2000 - precision: 0.373 - recall: 0.364
precion/recall curves 1950 / 2000 - precision: 0.367 - recall: 0.367
precion/recall curves 2000 / 2000 - precision: 0.361 - recall: 0.371

test use time - 00:01:22

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 10/25 - current_alpha: 0.00104219 - loss: 0.170107 - 00:03:58

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.820 - recall: 0.021
precion/recall curves  100 / 2000 - precision: 0.700 - recall: 0.036
precion/recall curves  150 / 2000 - precision: 0.707 - recall: 0.054
precion/recall curves  200 / 2000 - precision: 0.700 - recall: 0.072
precion/recall curves  250 / 2000 - precision: 0.664 - recall: 0.085
precion/recall curves  300 / 2000 - precision: 0.647 - recall: 0.099
precion/recall curves  350 / 2000 - precision: 0.631 - recall: 0.113
precion/recall curves  400 / 2000 - precision: 0.630 - recall: 0.129
precion/recall curves  450 / 2000 - precision: 0.611 - recall: 0.141
precion/recall curves  500 / 2000 - precision: 0.606 - recall: 0.155
precion/recall curves  550 / 2000 - precision: 0.585 - recall: 0.165
precion/recall curves  600 / 2000 - precision: 0.575 - recall: 0.177
precion/recall curves  650 / 2000 - precision: 0.565 - recall: 0.188
precion/recall curves  700 / 2000 - precision: 0.554 - recall: 0.199
precion/recall curves  750 / 2000 - precision: 0.547 - recall: 0.210
precion/recall curves  800 / 2000 - precision: 0.533 - recall: 0.218
precion/recall curves  850 / 2000 - precision: 0.526 - recall: 0.229
precion/recall curves  900 / 2000 - precision: 0.516 - recall: 0.238
precion/recall curves  950 / 2000 - precision: 0.506 - recall: 0.247
precion/recall curves 1000 / 2000 - precision: 0.497 - recall: 0.255
precion/recall curves 1050 / 2000 - precision: 0.486 - recall: 0.262
precion/recall curves 1100 / 2000 - precision: 0.476 - recall: 0.269
precion/recall curves 1150 / 2000 - precision: 0.472 - recall: 0.278
precion/recall curves 1200 / 2000 - precision: 0.463 - recall: 0.285
precion/recall curves 1250 / 2000 - precision: 0.454 - recall: 0.291
precion/recall curves 1300 / 2000 - precision: 0.444 - recall: 0.296
precion/recall curves 1350 / 2000 - precision: 0.438 - recall: 0.303
precion/recall curves 1400 / 2000 - precision: 0.428 - recall: 0.307
precion/recall curves 1450 / 2000 - precision: 0.426 - recall: 0.316
precion/recall curves 1500 / 2000 - precision: 0.417 - recall: 0.321
precion/recall curves 1550 / 2000 - precision: 0.409 - recall: 0.325
precion/recall curves 1600 / 2000 - precision: 0.403 - recall: 0.331
precion/recall curves 1650 / 2000 - precision: 0.398 - recall: 0.337
precion/recall curves 1700 / 2000 - precision: 0.392 - recall: 0.342
precion/recall curves 1750 / 2000 - precision: 0.387 - recall: 0.348
precion/recall curves 1800 / 2000 - precision: 0.384 - recall: 0.354
precion/recall curves 1850 / 2000 - precision: 0.379 - recall: 0.359
precion/recall curves 1900 / 2000 - precision: 0.372 - recall: 0.363
precion/recall curves 1950 / 2000 - precision: 0.367 - recall: 0.367
precion/recall curves 2000 / 2000 - precision: 0.363 - recall: 0.372

test use time - 00:01:22

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 11/25 - current_alpha: 0.00102134 - loss: 0.164617 - 00:04:04

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.780 - recall: 0.020
precion/recall curves  100 / 2000 - precision: 0.680 - recall: 0.035
precion/recall curves  150 / 2000 - precision: 0.647 - recall: 0.050
precion/recall curves  200 / 2000 - precision: 0.635 - recall: 0.065
precion/recall curves  250 / 2000 - precision: 0.620 - recall: 0.079
precion/recall curves  300 / 2000 - precision: 0.627 - recall: 0.096
precion/recall curves  350 / 2000 - precision: 0.609 - recall: 0.109
precion/recall curves  400 / 2000 - precision: 0.600 - recall: 0.123
precion/recall curves  450 / 2000 - precision: 0.596 - recall: 0.137
precion/recall curves  500 / 2000 - precision: 0.580 - recall: 0.149
precion/recall curves  550 / 2000 - precision: 0.575 - recall: 0.162
precion/recall curves  600 / 2000 - precision: 0.577 - recall: 0.177
precion/recall curves  650 / 2000 - precision: 0.566 - recall: 0.189
precion/recall curves  700 / 2000 - precision: 0.557 - recall: 0.200
precion/recall curves  750 / 2000 - precision: 0.543 - recall: 0.209
precion/recall curves  800 / 2000 - precision: 0.535 - recall: 0.219
precion/recall curves  850 / 2000 - precision: 0.528 - recall: 0.230
precion/recall curves  900 / 2000 - precision: 0.520 - recall: 0.240
precion/recall curves  950 / 2000 - precision: 0.508 - recall: 0.248
precion/recall curves 1000 / 2000 - precision: 0.499 - recall: 0.256
precion/recall curves 1050 / 2000 - precision: 0.491 - recall: 0.265
precion/recall curves 1100 / 2000 - precision: 0.478 - recall: 0.270
precion/recall curves 1150 / 2000 - precision: 0.470 - recall: 0.277
precion/recall curves 1200 / 2000 - precision: 0.461 - recall: 0.284
precion/recall curves 1250 / 2000 - precision: 0.452 - recall: 0.290
precion/recall curves 1300 / 2000 - precision: 0.445 - recall: 0.297
precion/recall curves 1350 / 2000 - precision: 0.436 - recall: 0.302
precion/recall curves 1400 / 2000 - precision: 0.432 - recall: 0.310
precion/recall curves 1450 / 2000 - precision: 0.430 - recall: 0.319
precion/recall curves 1500 / 2000 - precision: 0.429 - recall: 0.330
precion/recall curves 1550 / 2000 - precision: 0.420 - recall: 0.334
precion/recall curves 1600 / 2000 - precision: 0.412 - recall: 0.338
precion/recall curves 1650 / 2000 - precision: 0.406 - recall: 0.344
precion/recall curves 1700 / 2000 - precision: 0.402 - recall: 0.350
precion/recall curves 1750 / 2000 - precision: 0.397 - recall: 0.356
precion/recall curves 1800 / 2000 - precision: 0.391 - recall: 0.361
precion/recall curves 1850 / 2000 - precision: 0.385 - recall: 0.366
precion/recall curves 1900 / 2000 - precision: 0.382 - recall: 0.372
precion/recall curves 1950 / 2000 - precision: 0.375 - recall: 0.375
precion/recall curves 2000 / 2000 - precision: 0.371 - recall: 0.381

test use time - 00:01:22

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 12/25 - current_alpha: 0.00100091 - loss: 0.158291 - 00:03:49

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.760 - recall: 0.019
precion/recall curves  100 / 2000 - precision: 0.680 - recall: 0.035
precion/recall curves  150 / 2000 - precision: 0.653 - recall: 0.050
precion/recall curves  200 / 2000 - precision: 0.640 - recall: 0.066
precion/recall curves  250 / 2000 - precision: 0.636 - recall: 0.082
precion/recall curves  300 / 2000 - precision: 0.623 - recall: 0.096
precion/recall curves  350 / 2000 - precision: 0.609 - recall: 0.109
precion/recall curves  400 / 2000 - precision: 0.595 - recall: 0.122
precion/recall curves  450 / 2000 - precision: 0.587 - recall: 0.135
precion/recall curves  500 / 2000 - precision: 0.576 - recall: 0.148
precion/recall curves  550 / 2000 - precision: 0.571 - recall: 0.161
precion/recall curves  600 / 2000 - precision: 0.562 - recall: 0.173
precion/recall curves  650 / 2000 - precision: 0.557 - recall: 0.186
precion/recall curves  700 / 2000 - precision: 0.550 - recall: 0.197
precion/recall curves  750 / 2000 - precision: 0.547 - recall: 0.210
precion/recall curves  800 / 2000 - precision: 0.538 - recall: 0.221
precion/recall curves  850 / 2000 - precision: 0.534 - recall: 0.233
precion/recall curves  900 / 2000 - precision: 0.521 - recall: 0.241
precion/recall curves  950 / 2000 - precision: 0.517 - recall: 0.252
precion/recall curves 1000 / 2000 - precision: 0.501 - recall: 0.257
precion/recall curves 1050 / 2000 - precision: 0.495 - recall: 0.267
precion/recall curves 1100 / 2000 - precision: 0.482 - recall: 0.272
precion/recall curves 1150 / 2000 - precision: 0.473 - recall: 0.279
precion/recall curves 1200 / 2000 - precision: 0.467 - recall: 0.287
precion/recall curves 1250 / 2000 - precision: 0.460 - recall: 0.295
precion/recall curves 1300 / 2000 - precision: 0.451 - recall: 0.301
precion/recall curves 1350 / 2000 - precision: 0.440 - recall: 0.305
precion/recall curves 1400 / 2000 - precision: 0.434 - recall: 0.311
precion/recall curves 1450 / 2000 - precision: 0.425 - recall: 0.316
precion/recall curves 1500 / 2000 - precision: 0.419 - recall: 0.323
precion/recall curves 1550 / 2000 - precision: 0.412 - recall: 0.328
precion/recall curves 1600 / 2000 - precision: 0.409 - recall: 0.335
precion/recall curves 1650 / 2000 - precision: 0.402 - recall: 0.341
precion/recall curves 1700 / 2000 - precision: 0.396 - recall: 0.345
precion/recall curves 1750 / 2000 - precision: 0.393 - recall: 0.353
precion/recall curves 1800 / 2000 - precision: 0.389 - recall: 0.359
precion/recall curves 1850 / 2000 - precision: 0.384 - recall: 0.364
precion/recall curves 1900 / 2000 - precision: 0.378 - recall: 0.369
precion/recall curves 1950 / 2000 - precision: 0.377 - recall: 0.377
precion/recall curves 2000 / 2000 - precision: 0.371 - recall: 0.381

test use time - 00:01:22

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 13/25 - current_alpha: 0.00098090 - loss: 0.157852 - 00:04:22

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.760 - recall: 0.019
precion/recall curves  100 / 2000 - precision: 0.690 - recall: 0.035
precion/recall curves  150 / 2000 - precision: 0.680 - recall: 0.052
precion/recall curves  200 / 2000 - precision: 0.665 - recall: 0.068
precion/recall curves  250 / 2000 - precision: 0.652 - recall: 0.084
precion/recall curves  300 / 2000 - precision: 0.613 - recall: 0.094
precion/recall curves  350 / 2000 - precision: 0.609 - recall: 0.109
precion/recall curves  400 / 2000 - precision: 0.600 - recall: 0.123
precion/recall curves  450 / 2000 - precision: 0.584 - recall: 0.135
precion/recall curves  500 / 2000 - precision: 0.592 - recall: 0.152
precion/recall curves  550 / 2000 - precision: 0.582 - recall: 0.164
precion/recall curves  600 / 2000 - precision: 0.572 - recall: 0.176
precion/recall curves  650 / 2000 - precision: 0.569 - recall: 0.190
precion/recall curves  700 / 2000 - precision: 0.570 - recall: 0.205
precion/recall curves  750 / 2000 - precision: 0.564 - recall: 0.217
precion/recall curves  800 / 2000 - precision: 0.555 - recall: 0.228
precion/recall curves  850 / 2000 - precision: 0.541 - recall: 0.236
precion/recall curves  900 / 2000 - precision: 0.530 - recall: 0.245
precion/recall curves  950 / 2000 - precision: 0.520 - recall: 0.253
precion/recall curves 1000 / 2000 - precision: 0.507 - recall: 0.260
precion/recall curves 1050 / 2000 - precision: 0.494 - recall: 0.266
precion/recall curves 1100 / 2000 - precision: 0.489 - recall: 0.276
precion/recall curves 1150 / 2000 - precision: 0.482 - recall: 0.284
precion/recall curves 1200 / 2000 - precision: 0.477 - recall: 0.293
precion/recall curves 1250 / 2000 - precision: 0.470 - recall: 0.302
precion/recall curves 1300 / 2000 - precision: 0.461 - recall: 0.307
precion/recall curves 1350 / 2000 - precision: 0.451 - recall: 0.312
precion/recall curves 1400 / 2000 - precision: 0.444 - recall: 0.319
precion/recall curves 1450 / 2000 - precision: 0.438 - recall: 0.326
precion/recall curves 1500 / 2000 - precision: 0.435 - recall: 0.334
precion/recall curves 1550 / 2000 - precision: 0.425 - recall: 0.337
precion/recall curves 1600 / 2000 - precision: 0.416 - recall: 0.342
precion/recall curves 1650 / 2000 - precision: 0.411 - recall: 0.348
precion/recall curves 1700 / 2000 - precision: 0.405 - recall: 0.353
precion/recall curves 1750 / 2000 - precision: 0.397 - recall: 0.356
precion/recall curves 1800 / 2000 - precision: 0.392 - recall: 0.362
precion/recall curves 1850 / 2000 - precision: 0.387 - recall: 0.367
precion/recall curves 1900 / 2000 - precision: 0.383 - recall: 0.373
precion/recall curves 1950 / 2000 - precision: 0.377 - recall: 0.377
precion/recall curves 2000 / 2000 - precision: 0.374 - recall: 0.384

test use time - 00:01:22

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 14/25 - current_alpha: 0.00096128 - loss: 0.153716 - 00:03:42

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.720 - recall: 0.018
precion/recall curves  100 / 2000 - precision: 0.710 - recall: 0.036
precion/recall curves  150 / 2000 - precision: 0.687 - recall: 0.053
precion/recall curves  200 / 2000 - precision: 0.675 - recall: 0.069
precion/recall curves  250 / 2000 - precision: 0.640 - recall: 0.082
precion/recall curves  300 / 2000 - precision: 0.620 - recall: 0.095
precion/recall curves  350 / 2000 - precision: 0.600 - recall: 0.108
precion/recall curves  400 / 2000 - precision: 0.600 - recall: 0.123
precion/recall curves  450 / 2000 - precision: 0.591 - recall: 0.136
precion/recall curves  500 / 2000 - precision: 0.582 - recall: 0.149
precion/recall curves  550 / 2000 - precision: 0.573 - recall: 0.162
precion/recall curves  600 / 2000 - precision: 0.565 - recall: 0.174
precion/recall curves  650 / 2000 - precision: 0.560 - recall: 0.187
precion/recall curves  700 / 2000 - precision: 0.561 - recall: 0.202
precion/recall curves  750 / 2000 - precision: 0.551 - recall: 0.212
precion/recall curves  800 / 2000 - precision: 0.545 - recall: 0.224
precion/recall curves  850 / 2000 - precision: 0.533 - recall: 0.232
precion/recall curves  900 / 2000 - precision: 0.521 - recall: 0.241
precion/recall curves  950 / 2000 - precision: 0.512 - recall: 0.249
precion/recall curves 1000 / 2000 - precision: 0.507 - recall: 0.260
precion/recall curves 1050 / 2000 - precision: 0.495 - recall: 0.267
precion/recall curves 1100 / 2000 - precision: 0.492 - recall: 0.277
precion/recall curves 1150 / 2000 - precision: 0.487 - recall: 0.287
precion/recall curves 1200 / 2000 - precision: 0.477 - recall: 0.293
precion/recall curves 1250 / 2000 - precision: 0.470 - recall: 0.301
precion/recall curves 1300 / 2000 - precision: 0.458 - recall: 0.306
precion/recall curves 1350 / 2000 - precision: 0.456 - recall: 0.315
precion/recall curves 1400 / 2000 - precision: 0.449 - recall: 0.322
precion/recall curves 1450 / 2000 - precision: 0.439 - recall: 0.326
precion/recall curves 1500 / 2000 - precision: 0.431 - recall: 0.332
precion/recall curves 1550 / 2000 - precision: 0.425 - recall: 0.337
precion/recall curves 1600 / 2000 - precision: 0.417 - recall: 0.343
precion/recall curves 1650 / 2000 - precision: 0.412 - recall: 0.349
precion/recall curves 1700 / 2000 - precision: 0.406 - recall: 0.354
precion/recall curves 1750 / 2000 - precision: 0.401 - recall: 0.360
precion/recall curves 1800 / 2000 - precision: 0.396 - recall: 0.366
precion/recall curves 1850 / 2000 - precision: 0.391 - recall: 0.371
precion/recall curves 1900 / 2000 - precision: 0.389 - recall: 0.379
precion/recall curves 1950 / 2000 - precision: 0.381 - recall: 0.381
precion/recall curves 2000 / 2000 - precision: 0.376 - recall: 0.386

test use time - 00:01:22

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 15/25 - current_alpha: 0.00094205 - loss: 0.150468 - 00:04:12

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.780 - recall: 0.020
precion/recall curves  100 / 2000 - precision: 0.710 - recall: 0.036
precion/recall curves  150 / 2000 - precision: 0.693 - recall: 0.053
precion/recall curves  200 / 2000 - precision: 0.675 - recall: 0.069
precion/recall curves  250 / 2000 - precision: 0.688 - recall: 0.088
precion/recall curves  300 / 2000 - precision: 0.653 - recall: 0.101
precion/recall curves  350 / 2000 - precision: 0.629 - recall: 0.113
precion/recall curves  400 / 2000 - precision: 0.598 - recall: 0.123
precion/recall curves  450 / 2000 - precision: 0.582 - recall: 0.134
precion/recall curves  500 / 2000 - precision: 0.580 - recall: 0.149
precion/recall curves  550 / 2000 - precision: 0.576 - recall: 0.163
precion/recall curves  600 / 2000 - precision: 0.570 - recall: 0.175
precion/recall curves  650 / 2000 - precision: 0.555 - recall: 0.185
precion/recall curves  700 / 2000 - precision: 0.544 - recall: 0.195
precion/recall curves  750 / 2000 - precision: 0.536 - recall: 0.206
precion/recall curves  800 / 2000 - precision: 0.530 - recall: 0.217
precion/recall curves  850 / 2000 - precision: 0.524 - recall: 0.228
precion/recall curves  900 / 2000 - precision: 0.519 - recall: 0.239
precion/recall curves  950 / 2000 - precision: 0.512 - recall: 0.249
precion/recall curves 1000 / 2000 - precision: 0.504 - recall: 0.258
precion/recall curves 1050 / 2000 - precision: 0.494 - recall: 0.266
precion/recall curves 1100 / 2000 - precision: 0.488 - recall: 0.275
precion/recall curves 1150 / 2000 - precision: 0.485 - recall: 0.286
precion/recall curves 1200 / 2000 - precision: 0.478 - recall: 0.294
precion/recall curves 1250 / 2000 - precision: 0.470 - recall: 0.301
precion/recall curves 1300 / 2000 - precision: 0.459 - recall: 0.306
precion/recall curves 1350 / 2000 - precision: 0.450 - recall: 0.312
precion/recall curves 1400 / 2000 - precision: 0.441 - recall: 0.316
precion/recall curves 1450 / 2000 - precision: 0.434 - recall: 0.323
precion/recall curves 1500 / 2000 - precision: 0.424 - recall: 0.326
precion/recall curves 1550 / 2000 - precision: 0.421 - recall: 0.334
precion/recall curves 1600 / 2000 - precision: 0.414 - recall: 0.339
precion/recall curves 1650 / 2000 - precision: 0.412 - recall: 0.348
precion/recall curves 1700 / 2000 - precision: 0.407 - recall: 0.355
precion/recall curves 1750 / 2000 - precision: 0.401 - recall: 0.359
precion/recall curves 1800 / 2000 - precision: 0.395 - recall: 0.365
precion/recall curves 1850 / 2000 - precision: 0.390 - recall: 0.370
precion/recall curves 1900 / 2000 - precision: 0.385 - recall: 0.375
precion/recall curves 1950 / 2000 - precision: 0.379 - recall: 0.379
precion/recall curves 2000 / 2000 - precision: 0.377 - recall: 0.386

test use time - 00:01:22

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 16/25 - current_alpha: 0.00092321 - loss: 0.145180 - 00:04:06

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.700 - recall: 0.018
precion/recall curves  100 / 2000 - precision: 0.750 - recall: 0.038
precion/recall curves  150 / 2000 - precision: 0.713 - recall: 0.055
precion/recall curves  200 / 2000 - precision: 0.700 - recall: 0.072
precion/recall curves  250 / 2000 - precision: 0.668 - recall: 0.086
precion/recall curves  300 / 2000 - precision: 0.640 - recall: 0.098
precion/recall curves  350 / 2000 - precision: 0.626 - recall: 0.112
precion/recall curves  400 / 2000 - precision: 0.615 - recall: 0.126
precion/recall curves  450 / 2000 - precision: 0.600 - recall: 0.138
precion/recall curves  500 / 2000 - precision: 0.584 - recall: 0.150
precion/recall curves  550 / 2000 - precision: 0.575 - recall: 0.162
precion/recall curves  600 / 2000 - precision: 0.562 - recall: 0.173
precion/recall curves  650 / 2000 - precision: 0.549 - recall: 0.183
precion/recall curves  700 / 2000 - precision: 0.546 - recall: 0.196
precion/recall curves  750 / 2000 - precision: 0.543 - recall: 0.209
precion/recall curves  800 / 2000 - precision: 0.533 - recall: 0.218
precion/recall curves  850 / 2000 - precision: 0.532 - recall: 0.232
precion/recall curves  900 / 2000 - precision: 0.519 - recall: 0.239
precion/recall curves  950 / 2000 - precision: 0.512 - recall: 0.249
precion/recall curves 1000 / 2000 - precision: 0.507 - recall: 0.260
precion/recall curves 1050 / 2000 - precision: 0.498 - recall: 0.268
precion/recall curves 1100 / 2000 - precision: 0.494 - recall: 0.278
precion/recall curves 1150 / 2000 - precision: 0.484 - recall: 0.286
precion/recall curves 1200 / 2000 - precision: 0.477 - recall: 0.294
precion/recall curves 1250 / 2000 - precision: 0.469 - recall: 0.301
precion/recall curves 1300 / 2000 - precision: 0.464 - recall: 0.309
precion/recall curves 1350 / 2000 - precision: 0.456 - recall: 0.315
precion/recall curves 1400 / 2000 - precision: 0.449 - recall: 0.323
precion/recall curves 1450 / 2000 - precision: 0.443 - recall: 0.329
precion/recall curves 1500 / 2000 - precision: 0.438 - recall: 0.337
precion/recall curves 1550 / 2000 - precision: 0.428 - recall: 0.341
precion/recall curves 1600 / 2000 - precision: 0.424 - recall: 0.348
precion/recall curves 1650 / 2000 - precision: 0.416 - recall: 0.352
precion/recall curves 1700 / 2000 - precision: 0.409 - recall: 0.357
precion/recall curves 1750 / 2000 - precision: 0.403 - recall: 0.362
precion/recall curves 1800 / 2000 - precision: 0.400 - recall: 0.369
precion/recall curves 1850 / 2000 - precision: 0.395 - recall: 0.374
precion/recall curves 1900 / 2000 - precision: 0.391 - recall: 0.381
precion/recall curves 1950 / 2000 - precision: 0.387 - recall: 0.387
precion/recall curves 2000 / 2000 - precision: 0.380 - recall: 0.389

test use time - 00:01:22

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 17/25 - current_alpha: 0.00090475 - loss: 0.142947 - 00:03:53

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.840 - recall: 0.022
precion/recall curves  100 / 2000 - precision: 0.760 - recall: 0.039
precion/recall curves  150 / 2000 - precision: 0.720 - recall: 0.055
precion/recall curves  200 / 2000 - precision: 0.710 - recall: 0.073
precion/recall curves  250 / 2000 - precision: 0.672 - recall: 0.086
precion/recall curves  300 / 2000 - precision: 0.647 - recall: 0.099
precion/recall curves  350 / 2000 - precision: 0.634 - recall: 0.114
precion/recall curves  400 / 2000 - precision: 0.625 - recall: 0.128
precion/recall curves  450 / 2000 - precision: 0.613 - recall: 0.142
precion/recall curves  500 / 2000 - precision: 0.600 - recall: 0.154
precion/recall curves  550 / 2000 - precision: 0.593 - recall: 0.167
precion/recall curves  600 / 2000 - precision: 0.580 - recall: 0.178
precion/recall curves  650 / 2000 - precision: 0.571 - recall: 0.190
precion/recall curves  700 / 2000 - precision: 0.560 - recall: 0.201
precion/recall curves  750 / 2000 - precision: 0.559 - recall: 0.215
precion/recall curves  800 / 2000 - precision: 0.550 - recall: 0.226
precion/recall curves  850 / 2000 - precision: 0.544 - recall: 0.237
precion/recall curves  900 / 2000 - precision: 0.538 - recall: 0.248
precion/recall curves  950 / 2000 - precision: 0.528 - recall: 0.257
precion/recall curves 1000 / 2000 - precision: 0.517 - recall: 0.265
precion/recall curves 1050 / 2000 - precision: 0.503 - recall: 0.271
precion/recall curves 1100 / 2000 - precision: 0.495 - recall: 0.279
precion/recall curves 1150 / 2000 - precision: 0.491 - recall: 0.290
precion/recall curves 1200 / 2000 - precision: 0.484 - recall: 0.298
precion/recall curves 1250 / 2000 - precision: 0.477 - recall: 0.306
precion/recall curves 1300 / 2000 - precision: 0.465 - recall: 0.310
precion/recall curves 1350 / 2000 - precision: 0.457 - recall: 0.316
precion/recall curves 1400 / 2000 - precision: 0.451 - recall: 0.324
precion/recall curves 1450 / 2000 - precision: 0.443 - recall: 0.329
precion/recall curves 1500 / 2000 - precision: 0.438 - recall: 0.337
precion/recall curves 1550 / 2000 - precision: 0.432 - recall: 0.344
precion/recall curves 1600 / 2000 - precision: 0.427 - recall: 0.350
precion/recall curves 1650 / 2000 - precision: 0.420 - recall: 0.355
precion/recall curves 1700 / 2000 - precision: 0.414 - recall: 0.361
precion/recall curves 1750 / 2000 - precision: 0.411 - recall: 0.369
precion/recall curves 1800 / 2000 - precision: 0.405 - recall: 0.374
precion/recall curves 1850 / 2000 - precision: 0.398 - recall: 0.378
precion/recall curves 1900 / 2000 - precision: 0.392 - recall: 0.382
precion/recall curves 1950 / 2000 - precision: 0.388 - recall: 0.388
precion/recall curves 2000 / 2000 - precision: 0.380 - recall: 0.390

test use time - 00:01:22

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 18/25 - current_alpha: 0.00088665 - loss: 0.138729 - 00:03:56

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.800 - recall: 0.021
precion/recall curves  100 / 2000 - precision: 0.780 - recall: 0.040
precion/recall curves  150 / 2000 - precision: 0.727 - recall: 0.056
precion/recall curves  200 / 2000 - precision: 0.695 - recall: 0.071
precion/recall curves  250 / 2000 - precision: 0.676 - recall: 0.087
precion/recall curves  300 / 2000 - precision: 0.643 - recall: 0.099
precion/recall curves  350 / 2000 - precision: 0.620 - recall: 0.111
precion/recall curves  400 / 2000 - precision: 0.615 - recall: 0.126
precion/recall curves  450 / 2000 - precision: 0.613 - recall: 0.142
precion/recall curves  500 / 2000 - precision: 0.612 - recall: 0.157
precion/recall curves  550 / 2000 - precision: 0.605 - recall: 0.171
precion/recall curves  600 / 2000 - precision: 0.588 - recall: 0.181
precion/recall curves  650 / 2000 - precision: 0.577 - recall: 0.192
precion/recall curves  700 / 2000 - precision: 0.567 - recall: 0.204
precion/recall curves  750 / 2000 - precision: 0.553 - recall: 0.213
precion/recall curves  800 / 2000 - precision: 0.543 - recall: 0.223
precion/recall curves  850 / 2000 - precision: 0.533 - recall: 0.232
precion/recall curves  900 / 2000 - precision: 0.521 - recall: 0.241
precion/recall curves  950 / 2000 - precision: 0.518 - recall: 0.252
precion/recall curves 1000 / 2000 - precision: 0.511 - recall: 0.262
precion/recall curves 1050 / 2000 - precision: 0.506 - recall: 0.272
precion/recall curves 1100 / 2000 - precision: 0.502 - recall: 0.283
precion/recall curves 1150 / 2000 - precision: 0.490 - recall: 0.289
precion/recall curves 1200 / 2000 - precision: 0.477 - recall: 0.293
precion/recall curves 1250 / 2000 - precision: 0.469 - recall: 0.301
precion/recall curves 1300 / 2000 - precision: 0.463 - recall: 0.309
precion/recall curves 1350 / 2000 - precision: 0.453 - recall: 0.314
precion/recall curves 1400 / 2000 - precision: 0.449 - recall: 0.323
precion/recall curves 1450 / 2000 - precision: 0.443 - recall: 0.329
precion/recall curves 1500 / 2000 - precision: 0.434 - recall: 0.334
precion/recall curves 1550 / 2000 - precision: 0.427 - recall: 0.339
precion/recall curves 1600 / 2000 - precision: 0.421 - recall: 0.346
precion/recall curves 1650 / 2000 - precision: 0.419 - recall: 0.355
precion/recall curves 1700 / 2000 - precision: 0.415 - recall: 0.362
precion/recall curves 1750 / 2000 - precision: 0.410 - recall: 0.368
precion/recall curves 1800 / 2000 - precision: 0.404 - recall: 0.373
precion/recall curves 1850 / 2000 - precision: 0.400 - recall: 0.379
precion/recall curves 1900 / 2000 - precision: 0.392 - recall: 0.382
precion/recall curves 1950 / 2000 - precision: 0.385 - recall: 0.385
precion/recall curves 2000 / 2000 - precision: 0.380 - recall: 0.390

test use time - 00:01:23

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 19/25 - current_alpha: 0.00086892 - loss: 0.137877 - 00:04:07

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.760 - recall: 0.019
precion/recall curves  100 / 2000 - precision: 0.720 - recall: 0.037
precion/recall curves  150 / 2000 - precision: 0.693 - recall: 0.053
precion/recall curves  200 / 2000 - precision: 0.690 - recall: 0.071
precion/recall curves  250 / 2000 - precision: 0.672 - recall: 0.086
precion/recall curves  300 / 2000 - precision: 0.657 - recall: 0.101
precion/recall curves  350 / 2000 - precision: 0.631 - recall: 0.113
precion/recall curves  400 / 2000 - precision: 0.620 - recall: 0.127
precion/recall curves  450 / 2000 - precision: 0.613 - recall: 0.142
precion/recall curves  500 / 2000 - precision: 0.596 - recall: 0.153
precion/recall curves  550 / 2000 - precision: 0.580 - recall: 0.164
precion/recall curves  600 / 2000 - precision: 0.575 - recall: 0.177
precion/recall curves  650 / 2000 - precision: 0.568 - recall: 0.189
precion/recall curves  700 / 2000 - precision: 0.559 - recall: 0.201
precion/recall curves  750 / 2000 - precision: 0.548 - recall: 0.211
precion/recall curves  800 / 2000 - precision: 0.538 - recall: 0.221
precion/recall curves  850 / 2000 - precision: 0.524 - recall: 0.228
precion/recall curves  900 / 2000 - precision: 0.520 - recall: 0.240
precion/recall curves  950 / 2000 - precision: 0.516 - recall: 0.251
precion/recall curves 1000 / 2000 - precision: 0.508 - recall: 0.261
precion/recall curves 1050 / 2000 - precision: 0.504 - recall: 0.271
precion/recall curves 1100 / 2000 - precision: 0.495 - recall: 0.279
precion/recall curves 1150 / 2000 - precision: 0.489 - recall: 0.288
precion/recall curves 1200 / 2000 - precision: 0.484 - recall: 0.298
precion/recall curves 1250 / 2000 - precision: 0.476 - recall: 0.305
precion/recall curves 1300 / 2000 - precision: 0.468 - recall: 0.312
precion/recall curves 1350 / 2000 - precision: 0.463 - recall: 0.321
precion/recall curves 1400 / 2000 - precision: 0.455 - recall: 0.327
precion/recall curves 1450 / 2000 - precision: 0.446 - recall: 0.331
precion/recall curves 1500 / 2000 - precision: 0.441 - recall: 0.339
precion/recall curves 1550 / 2000 - precision: 0.435 - recall: 0.346
precion/recall curves 1600 / 2000 - precision: 0.426 - recall: 0.349
precion/recall curves 1650 / 2000 - precision: 0.422 - recall: 0.357
precion/recall curves 1700 / 2000 - precision: 0.416 - recall: 0.363
precion/recall curves 1750 / 2000 - precision: 0.408 - recall: 0.366
precion/recall curves 1800 / 2000 - precision: 0.402 - recall: 0.371
precion/recall curves 1850 / 2000 - precision: 0.398 - recall: 0.378
precion/recall curves 1900 / 2000 - precision: 0.390 - recall: 0.380
precion/recall curves 1950 / 2000 - precision: 0.385 - recall: 0.385
precion/recall curves 2000 / 2000 - precision: 0.378 - recall: 0.388

test use time - 00:01:22

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 20/25 - current_alpha: 0.00085154 - loss: 0.135148 - 00:04:04

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.760 - recall: 0.019
precion/recall curves  100 / 2000 - precision: 0.750 - recall: 0.038
precion/recall curves  150 / 2000 - precision: 0.700 - recall: 0.054
precion/recall curves  200 / 2000 - precision: 0.670 - recall: 0.069
precion/recall curves  250 / 2000 - precision: 0.664 - recall: 0.085
precion/recall curves  300 / 2000 - precision: 0.653 - recall: 0.101
precion/recall curves  350 / 2000 - precision: 0.640 - recall: 0.115
precion/recall curves  400 / 2000 - precision: 0.625 - recall: 0.128
precion/recall curves  450 / 2000 - precision: 0.613 - recall: 0.142
precion/recall curves  500 / 2000 - precision: 0.600 - recall: 0.154
precion/recall curves  550 / 2000 - precision: 0.580 - recall: 0.164
precion/recall curves  600 / 2000 - precision: 0.575 - recall: 0.177
precion/recall curves  650 / 2000 - precision: 0.562 - recall: 0.187
precion/recall curves  700 / 2000 - precision: 0.551 - recall: 0.198
precion/recall curves  750 / 2000 - precision: 0.544 - recall: 0.209
precion/recall curves  800 / 2000 - precision: 0.526 - recall: 0.216
precion/recall curves  850 / 2000 - precision: 0.518 - recall: 0.226
precion/recall curves  900 / 2000 - precision: 0.511 - recall: 0.236
precion/recall curves  950 / 2000 - precision: 0.501 - recall: 0.244
precion/recall curves 1000 / 2000 - precision: 0.499 - recall: 0.256
precion/recall curves 1050 / 2000 - precision: 0.490 - recall: 0.264
precion/recall curves 1100 / 2000 - precision: 0.484 - recall: 0.273
precion/recall curves 1150 / 2000 - precision: 0.476 - recall: 0.281
precion/recall curves 1200 / 2000 - precision: 0.470 - recall: 0.289
precion/recall curves 1250 / 2000 - precision: 0.464 - recall: 0.297
precion/recall curves 1300 / 2000 - precision: 0.462 - recall: 0.308
precion/recall curves 1350 / 2000 - precision: 0.450 - recall: 0.311
precion/recall curves 1400 / 2000 - precision: 0.441 - recall: 0.316
precion/recall curves 1450 / 2000 - precision: 0.433 - recall: 0.322
precion/recall curves 1500 / 2000 - precision: 0.427 - recall: 0.328
precion/recall curves 1550 / 2000 - precision: 0.423 - recall: 0.336
precion/recall curves 1600 / 2000 - precision: 0.417 - recall: 0.343
precion/recall curves 1650 / 2000 - precision: 0.407 - recall: 0.345
precion/recall curves 1700 / 2000 - precision: 0.405 - recall: 0.353
precion/recall curves 1750 / 2000 - precision: 0.398 - recall: 0.357
precion/recall curves 1800 / 2000 - precision: 0.395 - recall: 0.365
precion/recall curves 1850 / 2000 - precision: 0.391 - recall: 0.371
precion/recall curves 1900 / 2000 - precision: 0.384 - recall: 0.374
precion/recall curves 1950 / 2000 - precision: 0.380 - recall: 0.380
precion/recall curves 2000 / 2000 - precision: 0.375 - recall: 0.385

test use time - 00:01:19

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 21/25 - current_alpha: 0.00083451 - loss: 0.132989 - 00:04:03

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.740 - recall: 0.019
precion/recall curves  100 / 2000 - precision: 0.720 - recall: 0.037
precion/recall curves  150 / 2000 - precision: 0.707 - recall: 0.054
precion/recall curves  200 / 2000 - precision: 0.705 - recall: 0.072
precion/recall curves  250 / 2000 - precision: 0.672 - recall: 0.086
precion/recall curves  300 / 2000 - precision: 0.647 - recall: 0.099
precion/recall curves  350 / 2000 - precision: 0.640 - recall: 0.115
precion/recall curves  400 / 2000 - precision: 0.618 - recall: 0.127
precion/recall curves  450 / 2000 - precision: 0.607 - recall: 0.140
precion/recall curves  500 / 2000 - precision: 0.600 - recall: 0.154
precion/recall curves  550 / 2000 - precision: 0.600 - recall: 0.169
precion/recall curves  600 / 2000 - precision: 0.597 - recall: 0.184
precion/recall curves  650 / 2000 - precision: 0.577 - recall: 0.192
precion/recall curves  700 / 2000 - precision: 0.566 - recall: 0.203
precion/recall curves  750 / 2000 - precision: 0.549 - recall: 0.211
precion/recall curves  800 / 2000 - precision: 0.543 - recall: 0.223
precion/recall curves  850 / 2000 - precision: 0.536 - recall: 0.234
precion/recall curves  900 / 2000 - precision: 0.530 - recall: 0.245
precion/recall curves  950 / 2000 - precision: 0.525 - recall: 0.256
precion/recall curves 1000 / 2000 - precision: 0.519 - recall: 0.266
precion/recall curves 1050 / 2000 - precision: 0.506 - recall: 0.272
precion/recall curves 1100 / 2000 - precision: 0.495 - recall: 0.279
precion/recall curves 1150 / 2000 - precision: 0.489 - recall: 0.288
precion/recall curves 1200 / 2000 - precision: 0.479 - recall: 0.295
precion/recall curves 1250 / 2000 - precision: 0.473 - recall: 0.303
precion/recall curves 1300 / 2000 - precision: 0.468 - recall: 0.312
precion/recall curves 1350 / 2000 - precision: 0.461 - recall: 0.319
precion/recall curves 1400 / 2000 - precision: 0.452 - recall: 0.325
precion/recall curves 1450 / 2000 - precision: 0.443 - recall: 0.329
precion/recall curves 1500 / 2000 - precision: 0.437 - recall: 0.336
precion/recall curves 1550 / 2000 - precision: 0.431 - recall: 0.343
precion/recall curves 1600 / 2000 - precision: 0.423 - recall: 0.347
precion/recall curves 1650 / 2000 - precision: 0.416 - recall: 0.352
precion/recall curves 1700 / 2000 - precision: 0.415 - recall: 0.362
precion/recall curves 1750 / 2000 - precision: 0.411 - recall: 0.369
precion/recall curves 1800 / 2000 - precision: 0.404 - recall: 0.373
precion/recall curves 1850 / 2000 - precision: 0.399 - recall: 0.378
precion/recall curves 1900 / 2000 - precision: 0.394 - recall: 0.384
precion/recall curves 1950 / 2000 - precision: 0.388 - recall: 0.388
precion/recall curves 2000 / 2000 - precision: 0.384 - recall: 0.394

test use time - 00:01:18

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 22/25 - current_alpha: 0.00081782 - loss: 0.130612 - 00:04:07

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.740 - recall: 0.019
precion/recall curves  100 / 2000 - precision: 0.760 - recall: 0.039
precion/recall curves  150 / 2000 - precision: 0.733 - recall: 0.056
precion/recall curves  200 / 2000 - precision: 0.720 - recall: 0.074
precion/recall curves  250 / 2000 - precision: 0.684 - recall: 0.088
precion/recall curves  300 / 2000 - precision: 0.650 - recall: 0.100
precion/recall curves  350 / 2000 - precision: 0.620 - recall: 0.111
precion/recall curves  400 / 2000 - precision: 0.613 - recall: 0.126
precion/recall curves  450 / 2000 - precision: 0.591 - recall: 0.136
precion/recall curves  500 / 2000 - precision: 0.596 - recall: 0.153
precion/recall curves  550 / 2000 - precision: 0.593 - recall: 0.167
precion/recall curves  600 / 2000 - precision: 0.578 - recall: 0.178
precion/recall curves  650 / 2000 - precision: 0.565 - recall: 0.188
precion/recall curves  700 / 2000 - precision: 0.557 - recall: 0.200
precion/recall curves  750 / 2000 - precision: 0.560 - recall: 0.215
precion/recall curves  800 / 2000 - precision: 0.558 - recall: 0.229
precion/recall curves  850 / 2000 - precision: 0.553 - recall: 0.241
precion/recall curves  900 / 2000 - precision: 0.543 - recall: 0.251
precion/recall curves  950 / 2000 - precision: 0.529 - recall: 0.258
precion/recall curves 1000 / 2000 - precision: 0.522 - recall: 0.268
precion/recall curves 1050 / 2000 - precision: 0.518 - recall: 0.279
precion/recall curves 1100 / 2000 - precision: 0.508 - recall: 0.287
precion/recall curves 1150 / 2000 - precision: 0.497 - recall: 0.293
precion/recall curves 1200 / 2000 - precision: 0.484 - recall: 0.298
precion/recall curves 1250 / 2000 - precision: 0.476 - recall: 0.305
precion/recall curves 1300 / 2000 - precision: 0.467 - recall: 0.311
precion/recall curves 1350 / 2000 - precision: 0.460 - recall: 0.318
precion/recall curves 1400 / 2000 - precision: 0.452 - recall: 0.325
precion/recall curves 1450 / 2000 - precision: 0.444 - recall: 0.330
precion/recall curves 1500 / 2000 - precision: 0.439 - recall: 0.338
precion/recall curves 1550 / 2000 - precision: 0.435 - recall: 0.346
precion/recall curves 1600 / 2000 - precision: 0.428 - recall: 0.351
precion/recall curves 1650 / 2000 - precision: 0.419 - recall: 0.355
precion/recall curves 1700 / 2000 - precision: 0.415 - recall: 0.362
precion/recall curves 1750 / 2000 - precision: 0.407 - recall: 0.365
precion/recall curves 1800 / 2000 - precision: 0.399 - recall: 0.368
precion/recall curves 1850 / 2000 - precision: 0.393 - recall: 0.373
precion/recall curves 1900 / 2000 - precision: 0.388 - recall: 0.378
precion/recall curves 1950 / 2000 - precision: 0.384 - recall: 0.384
precion/recall curves 2000 / 2000 - precision: 0.380 - recall: 0.390

test use time - 00:01:19

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 23/25 - current_alpha: 0.00080146 - loss: 0.127765 - 00:03:55

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.740 - recall: 0.019
precion/recall curves  100 / 2000 - precision: 0.740 - recall: 0.038
precion/recall curves  150 / 2000 - precision: 0.700 - recall: 0.054
precion/recall curves  200 / 2000 - precision: 0.690 - recall: 0.071
precion/recall curves  250 / 2000 - precision: 0.676 - recall: 0.087
precion/recall curves  300 / 2000 - precision: 0.653 - recall: 0.101
precion/recall curves  350 / 2000 - precision: 0.637 - recall: 0.114
precion/recall curves  400 / 2000 - precision: 0.627 - recall: 0.129
precion/recall curves  450 / 2000 - precision: 0.616 - recall: 0.142
precion/recall curves  500 / 2000 - precision: 0.604 - recall: 0.155
precion/recall curves  550 / 2000 - precision: 0.584 - recall: 0.165
precion/recall curves  600 / 2000 - precision: 0.562 - recall: 0.173
precion/recall curves  650 / 2000 - precision: 0.557 - recall: 0.186
precion/recall curves  700 / 2000 - precision: 0.543 - recall: 0.195
precion/recall curves  750 / 2000 - precision: 0.537 - recall: 0.207
precion/recall curves  800 / 2000 - precision: 0.531 - recall: 0.218
precion/recall curves  850 / 2000 - precision: 0.529 - recall: 0.231
precion/recall curves  900 / 2000 - precision: 0.526 - recall: 0.243
precion/recall curves  950 / 2000 - precision: 0.519 - recall: 0.253
precion/recall curves 1000 / 2000 - precision: 0.503 - recall: 0.258
precion/recall curves 1050 / 2000 - precision: 0.494 - recall: 0.266
precion/recall curves 1100 / 2000 - precision: 0.489 - recall: 0.276
precion/recall curves 1150 / 2000 - precision: 0.483 - recall: 0.285
precion/recall curves 1200 / 2000 - precision: 0.477 - recall: 0.293
precion/recall curves 1250 / 2000 - precision: 0.466 - recall: 0.298
precion/recall curves 1300 / 2000 - precision: 0.456 - recall: 0.304
precion/recall curves 1350 / 2000 - precision: 0.448 - recall: 0.310
precion/recall curves 1400 / 2000 - precision: 0.443 - recall: 0.318
precion/recall curves 1450 / 2000 - precision: 0.434 - recall: 0.323
precion/recall curves 1500 / 2000 - precision: 0.429 - recall: 0.330
precion/recall curves 1550 / 2000 - precision: 0.425 - recall: 0.337
precion/recall curves 1600 / 2000 - precision: 0.420 - recall: 0.345
precion/recall curves 1650 / 2000 - precision: 0.415 - recall: 0.351
precion/recall curves 1700 / 2000 - precision: 0.409 - recall: 0.356
precion/recall curves 1750 / 2000 - precision: 0.402 - recall: 0.361
precion/recall curves 1800 / 2000 - precision: 0.397 - recall: 0.366
precion/recall curves 1850 / 2000 - precision: 0.391 - recall: 0.371
precion/recall curves 1900 / 2000 - precision: 0.387 - recall: 0.377
precion/recall curves 1950 / 2000 - precision: 0.383 - recall: 0.383
precion/recall curves 2000 / 2000 - precision: 0.377 - recall: 0.387

test use time - 00:01:19

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 24/25 - current_alpha: 0.00078543 - loss: 0.124412 - 00:03:38

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.740 - recall: 0.019
precion/recall curves  100 / 2000 - precision: 0.720 - recall: 0.037
precion/recall curves  150 / 2000 - precision: 0.720 - recall: 0.055
precion/recall curves  200 / 2000 - precision: 0.700 - recall: 0.072
precion/recall curves  250 / 2000 - precision: 0.692 - recall: 0.089
precion/recall curves  300 / 2000 - precision: 0.657 - recall: 0.101
precion/recall curves  350 / 2000 - precision: 0.654 - recall: 0.117
precion/recall curves  400 / 2000 - precision: 0.640 - recall: 0.131
precion/recall curves  450 / 2000 - precision: 0.611 - recall: 0.141
precion/recall curves  500 / 2000 - precision: 0.612 - recall: 0.157
precion/recall curves  550 / 2000 - precision: 0.593 - recall: 0.167
precion/recall curves  600 / 2000 - precision: 0.580 - recall: 0.178
precion/recall curves  650 / 2000 - precision: 0.571 - recall: 0.190
precion/recall curves  700 / 2000 - precision: 0.556 - recall: 0.199
precion/recall curves  750 / 2000 - precision: 0.549 - recall: 0.211
precion/recall curves  800 / 2000 - precision: 0.549 - recall: 0.225
precion/recall curves  850 / 2000 - precision: 0.541 - recall: 0.236
precion/recall curves  900 / 2000 - precision: 0.537 - recall: 0.248
precion/recall curves  950 / 2000 - precision: 0.527 - recall: 0.257
precion/recall curves 1000 / 2000 - precision: 0.515 - recall: 0.264
precion/recall curves 1050 / 2000 - precision: 0.507 - recall: 0.273
precion/recall curves 1100 / 2000 - precision: 0.501 - recall: 0.283
precion/recall curves 1150 / 2000 - precision: 0.489 - recall: 0.288
precion/recall curves 1200 / 2000 - precision: 0.482 - recall: 0.296
precion/recall curves 1250 / 2000 - precision: 0.474 - recall: 0.304
precion/recall curves 1300 / 2000 - precision: 0.461 - recall: 0.307
precion/recall curves 1350 / 2000 - precision: 0.456 - recall: 0.315
precion/recall curves 1400 / 2000 - precision: 0.448 - recall: 0.322
precion/recall curves 1450 / 2000 - precision: 0.439 - recall: 0.326
precion/recall curves 1500 / 2000 - precision: 0.432 - recall: 0.332
precion/recall curves 1550 / 2000 - precision: 0.428 - recall: 0.341
precion/recall curves 1600 / 2000 - precision: 0.424 - recall: 0.348
precion/recall curves 1650 / 2000 - precision: 0.415 - recall: 0.351
precion/recall curves 1700 / 2000 - precision: 0.410 - recall: 0.357
precion/recall curves 1750 / 2000 - precision: 0.406 - recall: 0.365
precion/recall curves 1800 / 2000 - precision: 0.400 - recall: 0.369
precion/recall curves 1850 / 2000 - precision: 0.395 - recall: 0.374
precion/recall curves 1900 / 2000 - precision: 0.392 - recall: 0.382
precion/recall curves 1950 / 2000 - precision: 0.389 - recall: 0.389
precion/recall curves 2000 / 2000 - precision: 0.383 - recall: 0.393

test use time - 00:01:19

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Epoch 25/25 - current_alpha: 0.00076973 - loss: 0.124694 - 00:04:05

##################################################

Test start...

Number of test samples for non NA relation: 1950

precion/recall curves   50 / 2000 - precision: 0.760 - recall: 0.019
precion/recall curves  100 / 2000 - precision: 0.730 - recall: 0.037
precion/recall curves  150 / 2000 - precision: 0.720 - recall: 0.055
precion/recall curves  200 / 2000 - precision: 0.715 - recall: 0.073
precion/recall curves  250 / 2000 - precision: 0.692 - recall: 0.089
precion/recall curves  300 / 2000 - precision: 0.657 - recall: 0.101
precion/recall curves  350 / 2000 - precision: 0.634 - recall: 0.114
precion/recall curves  400 / 2000 - precision: 0.623 - recall: 0.128
precion/recall curves  450 / 2000 - precision: 0.611 - recall: 0.141
precion/recall curves  500 / 2000 - precision: 0.590 - recall: 0.151
precion/recall curves  550 / 2000 - precision: 0.587 - recall: 0.166
precion/recall curves  600 / 2000 - precision: 0.577 - recall: 0.177
precion/recall curves  650 / 2000 - precision: 0.565 - recall: 0.188
precion/recall curves  700 / 2000 - precision: 0.551 - recall: 0.198
precion/recall curves  750 / 2000 - precision: 0.540 - recall: 0.208
precion/recall curves  800 / 2000 - precision: 0.533 - recall: 0.218
precion/recall curves  850 / 2000 - precision: 0.519 - recall: 0.226
precion/recall curves  900 / 2000 - precision: 0.520 - recall: 0.240
precion/recall curves  950 / 2000 - precision: 0.511 - recall: 0.249
precion/recall curves 1000 / 2000 - precision: 0.501 - recall: 0.257
precion/recall curves 1050 / 2000 - precision: 0.492 - recall: 0.265
precion/recall curves 1100 / 2000 - precision: 0.484 - recall: 0.273
precion/recall curves 1150 / 2000 - precision: 0.477 - recall: 0.282
precion/recall curves 1200 / 2000 - precision: 0.469 - recall: 0.289
precion/recall curves 1250 / 2000 - precision: 0.468 - recall: 0.300
precion/recall curves 1300 / 2000 - precision: 0.463 - recall: 0.309
precion/recall curves 1350 / 2000 - precision: 0.454 - recall: 0.314
precion/recall curves 1400 / 2000 - precision: 0.449 - recall: 0.323
precion/recall curves 1450 / 2000 - precision: 0.440 - recall: 0.327
precion/recall curves 1500 / 2000 - precision: 0.436 - recall: 0.335
precion/recall curves 1550 / 2000 - precision: 0.428 - recall: 0.341
precion/recall curves 1600 / 2000 - precision: 0.426 - recall: 0.350
precion/recall curves 1650 / 2000 - precision: 0.419 - recall: 0.354
precion/recall curves 1700 / 2000 - precision: 0.413 - recall: 0.360
precion/recall curves 1750 / 2000 - precision: 0.406 - recall: 0.365
precion/recall curves 1800 / 2000 - precision: 0.398 - recall: 0.368
precion/recall curves 1850 / 2000 - precision: 0.395 - recall: 0.374
precion/recall curves 1900 / 2000 - precision: 0.389 - recall: 0.379
precion/recall curves 1950 / 2000 - precision: 0.383 - recall: 0.383
precion/recall curves 2000 / 2000 - precision: 0.379 - recall: 0.389

test use time - 00:01:19

模型保存成功, 保存目录为: ./output/

Test end.

##################################################

Train end.

##################################################

$ tree
.
├── build
│   ├── test
│   └── train
├── clean.sh
├── init.h
├── output
│   ├── attention_weights.txt
│   ├── conv_1d.txt
│   ├── position_vec.txt
│   ├── pr.txt
│   ├── relation_matrix.txt
│   └── word2vec.txt
├── run.sh
├── test.cpp
├── test.h
└── train.cpp

2 directories, 14 files
$ bash clean.sh 

##################################################

./build 目录递归删除成功.

##################################################

$ tree
.
├── clean.sh
├── init.h
├── output
│   ├── attention_weights.txt
│   ├── conv_1d.txt
│   ├── position_vec.txt
│   ├── pr.txt
│   ├── relation_matrix.txt
│   └── word2vec.txt
├── run.sh
├── test.cpp
├── test.h
└── train.cpp

1 directory, 12 files
$ 
```

### 训练和测试的参数

#### train.cpp

```
// ./train [-batch BATCH] [-threads THREAD] [-alpha ALPHA]
//         [-init_rate INIT_RATE] [-reduce_epoch REDUCE_EPOCH]
//         [-epochs EPOCHS] [-limit LIMIT] [-dimension_pos DIMENSION_POS]
//         [-window WINDOW] [-dimension_c DIMENSION_C]
//         [-dropout DROPOUT] [-output_model 0/1]
//         [-note NOTE] [-data_path DATA_PATH]
//         [-output_path OUTPUT_PATH] [--help]

// optional arguments:
// -batch BATCH                   batch size. if unspecified, batch will default to [40]
// -threads THREAD                number of worker threads. if unspecified, num_threads will default to [32]
// -alpha ALPHA                   learning rate. if unspecified, alpha will default to [0.00125]
// -init_rate INIT_RATE           init rate of learning rate. if unspecified, current_rate will default to [1.0]
// -reduce_epoch REDUCE_EPOCH     reduce of init rate of learning rate per epoch. if unspecified, reduce_epoch will default to [0.98]
// -epochs EPOCHS                 number of epochs. if unspecified, epochs will default to [25]
// -limit LIMIT                   限制句子中 (头, 尾) 实体相对每个单词的最大距离. 默认值为 [30]
// -dimension_pos DIMENSION_POS   位置嵌入维度，默认值为 [5]
// -window WINDOW                 一维卷积的 window 大小. 默认值为 [3]
// -dimension_c DIMENSION_C       sentence embedding size, if unspecified, dimension_c will default to [230]
// -dropout DROPOUT               dropout probability. if unspecified, dropout_probability will default to [0.5]
// -output_model 0/1              [1] 保存模型, [0] 不保存模型. 默认值为 [1]
// -note NOTE                     information you want to add to the filename, like ("./output/word2vec" + note + ".txt"). if unspecified, note will default to ""
// -data_path DATA_PATH           folder of data. if unspecified, data_path will default to "../data/"
// -output_path OUTPUT_PATH       folder of outputing results (precion/recall curves) and models. if unspecified, output_path will default to "./output/"
// --help                         print help information of ./train
```

#### test.cpp

```
// ./test [-threads THREAD] [-dropout DROPOUT]
//        [-note NOTE] [-data_path DATA_PATH]
//        [-load_path LOAD_PATH] [--help]

// optional arguments:
// -threads THREAD                number of worker threads. if unspecified, num_threads will default to [32]
// -note NOTE                     information you want to add to the filename, like ("./output/word2vec" + note + ".txt"). if unspecified, note will default to ""
// -data_path DATA_PATH           folder of data. if unspecified, data_path will default to "../data/"
// -load_path LOAD_PATH           folder of pretrained models. if unspecified, load_path will default to "./output/"
// --help                         print help information of ./test
```

### 文件

- [init.h](./CNN+ATT/init.h): 该 C++ 文件用于初始化, 即读取训练数据和测试数据.

- [test.h](./CNN+ATT/test.h): 该 C++ 文件用于模型测试.

- [train.cpp](./CNN+ATT/train.cpp): 该 C++ 文件用于模型训练.

- [test.cpp](./CNN+ATT/test.cpp): 该 C++ 文件用于模型测试.

- [run.sh](./CNN+ATT/run.sh): 该 Shell 脚本用于模型训练和模型测试.

- [clean.sh](./CNN+ATT/clean.sh): 该 Shell 脚本用于清理临时文件.

## [papers](./papers/)

- [Neural Relation Extraction with Selective Attention over Instances.pdf](./papers/Neural%20Relation%20Extraction%20with%20Selective%20Attention%20over%20Instances.pdf): 已经读过的 **CNN+ATT** 论文.

## Reference

[1] Yankai Lin, Shiqi Shen, Zhiyuan Liu, Huanbo Luan, and Maosong Sun. Neural Relation Extraction with Selective Attention over Instances. In Proceedings of ACL, 2016.